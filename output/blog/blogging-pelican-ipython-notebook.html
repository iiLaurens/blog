<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Blogging with IPython notebooks in pelican - Laurens' geeky adventures</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://blog.laurens.xyz/blog/blogging-pelican-ipython-notebook.html">

        <meta name="author" content="Daniel Rodriguez" />
        <meta name="keywords" content="Python,Pelican" />
        <meta name="description" content="Update: Check out the updated post on blogging with iPython notebook and pelican with a plugin. It seems that I spend most time redesigning/developing this blog than actually blogging xD, just a few weeks ago I wrote about how I was blogging using jekyll with iPython notebooks and now ..." />

        <meta property="og:site_name" content="Laurens' geeky adventures" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Blogging with IPython notebooks in pelican"/>
        <meta property="og:url" content="http://blog.laurens.xyz/blog/blogging-pelican-ipython-notebook.html"/>
        <meta property="og:description" content="Update: Check out the updated post on blogging with iPython notebook and pelican with a plugin. It seems that I spend most time redesigning/developing this blog than actually blogging xD, just a few weeks ago I wrote about how I was blogging using jekyll with iPython notebooks and now ..."/>
        <meta property="article:published_time" content="2013-02-16" />
            <meta property="article:section" content="02" />
            <meta property="article:tag" content="Python" />
            <meta property="article:tag" content="Pelican" />
            <meta property="article:author" content="Daniel Rodriguez" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.laurens.xyz/theme/css/bootstrap.yeti.min.css" type="text/css"/>
    <link href="http://blog.laurens.xyz/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://blog.laurens.xyz/theme/css/pygments/zenburn.css" rel="stylesheet">
    <link href="http://blog.laurens.xyz/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.laurens.xyz/theme/css/style.css" type="text/css"/>





</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://blog.laurens.xyz/" class="navbar-brand">
Laurens' geeky adventures            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li ><a href="http://blog.laurens.xyz/tags.html">Tags</a></li>
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
              <li><a href="http://blog.laurens.xyz/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.laurens.xyz/blog/blogging-pelican-ipython-notebook.html"
                       rel="bookmark"
                       title="Permalink to Blogging with IPython notebooks in pelican">
                        Blogging with IPython notebooks in pelican
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-02-16T00:00:00+01:00"> 16-02-2013</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="http://blog.laurens.xyz/tags/python.html">Python</a>
        /
	<a href="http://blog.laurens.xyz/tags/pelican.html">Pelican</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p class='update'><strong>Update: </strong> Check out the updated post on <a href="http://blog.laurens.xyz/blog/pelican-ipython-notebook-plugin.html">blogging with iPython notebook and pelican with a plugin</a>.</p>

<p>It seems that I spend most time redesigning/developing this blog than actually
blogging xD, just a few weeks ago I wrote about how I was <a href="http://blog.laurens.xyz/blog/new-blog-using-jekyll-and-ipython.html">blogging using jekyll
with iPython notebooks</a>
and now I am talking about doing the same different static blog engine.</p>
<p>The fact is that a few days ago I found <a href="http://www.getpelican.com">pelican</a>, the first serious
python alternative to Jekyll I have found, and after reading 15 minutes about it I was
downloading pelican and creating a theme based on my old Jekyll site.</p>
<p>The switch was easy just needed move some files, change some of the tags from liquid to
<a href="http://jinja.pocoo.org/docs/">jinja2</a> and add some metadata. The fact of having
less than 10 posts also helped because I did that part manually.</p>
<p>The fact that <a href="http://www.getpelican.com">pelican</a> is on python gave me the idea of creating an
automated way of blogging with ipython notebooks, so I dive a little bit into
the <a href="http://docs.getpelican.com/">pelican documentation</a> (which is great) and decide to make it.</p>
<h2>How I did it</h2>
<p><a href="http://www.getpelican.com">Pelican</a> uses what thet call
<a href="http://docs.getpelican.com/en/3.1.1/internals.html#how-to-implement-a-new-reader">readers</a>
to read different formats
(markdown, rst, and now ipynb) and output general HTML so it is very easy to
implement a markup for any language. Also the iPython team has already a
very good <a href="https://github.com/ipython/nbconvert">set of converts</a> so all I did
was to copy and integrate that necessary code.</p>
<p>Finally I took some of the code from Jake Vanderplas when he talks about
<a href="http://jakevdp.github.com/blog/2012/10/04/blogging-with-ipython/">blogging with Octopress and iPython</a>.
The idea is to encapsulate the ipython notebook HTML and CSS so the CSS of
the site don't get messed up.</p>
<h2>How to use it</h2>
<p>I made a <a href="https://github.com/getpelican/pelican/pull/730">pull request</a>
on the official pelican repo but that may take some time so if if you are impatient can use
<a href="https://github.com/danielfrg/pelican/tree/ipythonnb-reader">my forked version (brach: ipythonnb-reader)</a>
or even just made the changes yourself as are just a few.</p>
<p>Before anything install pelican and ipython with <code>pip install pelican ipython</code> also markdown if you want</p>
<p>First, locate the pelican folder: mine is: <code>~/.virtualenvs/blog/lib/python2.7/site-packages/pelican/</code></p>
<p>At beginning of <code>readers.py</code> add this</p>
<div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">json</span>
    <span class="kn">import</span> <span class="nn">IPython</span>
    <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
    <span class="kn">from</span> <span class="nn">util.nbconverter.html</span> <span class="kn">import</span> <span class="n">ConverterHTML</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">IPython</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>


<p>On <code>readers.py</code> just before <code>_EXTENSIONS = {}</code> paste the main reader code</p>
<div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">IPythonReader</span><span class="p">(</span><span class="n">Reader</span><span class="p">):</span>
    <span class="n">enabled</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">IPython</span><span class="p">)</span>
    <span class="n">file_extensions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ipynb&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="n">text</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">converter</span> <span class="o">=</span> <span class="n">ConverterHTML</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">converter</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

        <span class="n">metadata_uni</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">text</span><span class="p">)[</span><span class="s1">&#39;metadata&#39;</span><span class="p">]</span>
        <span class="n">metadata2</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Change unicode encoding to utf-8</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metadata_uni</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
          <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">):</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
          <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">unicode</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
          <span class="n">metadata2</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">metadata2</span><span class="o">.</span><span class="n">iteritems</span><span class="p">():</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">metadata</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_metadata</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="n">metadata</span><span class="p">[</span><span class="s1">&#39;ipython&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

        <span class="n">content</span> <span class="o">=</span> <span class="n">converter</span><span class="o">.</span><span class="n">main_body</span><span class="p">()</span> <span class="c1"># Use the ipynb converter</span>
        <span class="c1"># change ipython css classes so it does not mess up the blog css</span>
        <span class="n">content</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">converter</span><span class="o">.</span><span class="n">main_body</span><span class="p">())</span>
        <span class="c1"># replace the highlight tags</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;class=&quot;highlight&quot;&#39;</span><span class="p">,</span> <span class="s1">&#39;class=&quot;highlight-ipynb&quot;&#39;</span><span class="p">)</span>
        <span class="c1"># specify &lt;pre&gt; tags</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;pre&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;pre class=&quot;ipynb&quot;&#39;</span><span class="p">)</span>
        <span class="c1"># create a special div for notebook</span>
        <span class="n">content</span> <span class="o">=</span> <span class="s1">&#39;&lt;div class=&quot;ipynb&quot;&gt;&#39;</span> <span class="o">+</span> <span class="n">content</span> <span class="o">+</span> <span class="s2">&quot;&lt;/div&gt;&quot;</span>
        <span class="c1"># Modify max-width for tables</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;max-width:1500px;&#39;</span><span class="p">,</span> <span class="s1">&#39;max-width:650px;&#39;</span><span class="p">)</span>
        <span class="c1"># h1,h2,...</span>
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="s1">&#39;123456&#39;</span><span class="p">:</span>
          <span class="n">content</span> <span class="o">=</span> <span class="n">content</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&lt;h</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">h</span><span class="p">,</span> <span class="s1">&#39;&lt;h</span><span class="si">%s</span><span class="s1"> class=&quot;ipynb&quot;&#39;</span> <span class="o">%</span> <span class="n">h</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">content</span><span class="p">,</span> <span class="n">metadata</span>
</pre></div>


<p>Second, Create a new folder called <code>util</code> on the pelican directory and then download
the <a href="https://github.com/danielfrg/pelican/tree/ipythonnb-reader/pelican/util">contents of my branch</a>
to that folder.</p>
<p>Now you are ready to blog with the iPython notebooks.</p>
<h2>How to blog</h2>
<p>First, need to update the MARKUP setting on <code>pelicanconf.py</code> to:
<code>MARKUP = ('md', 'ipynb')</code> that way pelican recognizes the <code>ipynb</code> format as an article.</p>
<p>Create you super amazing iPython notebook with charts, markdown, etc and save it to the
<code>content</code> folder of your pelican site.</p>
<p>Open the <code>.ipynb</code> file on your favorite text editor and should see something like this:</p>
<div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="nt">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Super iPython NB&quot;</span>
 <span class="p">},</span>
 <span class="err">{</span> <span class="err">A_LOT_OF_OTHER_STUFF</span> <span class="p">}</span>
</pre></div>


<p>Modify the file to:</p>
<div class="highlight"><pre><span></span><span class="p">{</span>
 <span class="nt">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
  <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Super iPython NB&quot;</span><span class="p">,</span>
  <span class="nt">&quot;Title&quot;</span><span class="p">:</span> <span class="s2">&quot;Blogging with iPython notebooks in pelican&quot;</span><span class="p">,</span>
  <span class="nt">&quot;Date&quot;</span><span class="p">:</span> <span class="s2">&quot;2013-2-16&quot;</span><span class="p">,</span>
  <span class="nt">&quot;Category&quot;</span><span class="p">:</span> <span class="s2">&quot;Category&quot;</span><span class="p">,</span>
  <span class="nt">&quot;Tags&quot;</span><span class="p">:</span> <span class="s2">&quot;tag2, tag2&quot;</span><span class="p">,</span>
  <span class="nt">&quot;slug&quot;</span><span class="p">:</span> <span class="s2">&quot;slug-slug-slug&quot;</span><span class="p">,</span>
  <span class="nt">&quot;Author&quot;</span><span class="p">:</span> <span class="s2">&quot;Me&quot;</span>
 <span class="p">},</span>
 <span class="err">{</span> <span class="err">A_LOT_OF_OTHER_STUFF</span> <span class="p">}</span>
</pre></div>


<p>Note that only the title and date tags are actually necessary.</p>
<p>Thats it, couldn't be more simple!</p>
<p>One final thing to do only once is to include the the
<a href="https://github.com/danielfrg/pelican/tree/ipythonnb-reader/pelican/themes/ipythonnb/css">ipython.min.css</a>
in your pelican theme. Since not all posts are going to be in iPython is not
necessary to include the css file on all pages; so to be more efficient
I created a metadata to identify which posts are from ipython notebooks
so you in your pelican <code>article.html</code> template should do:</p>
<div class="highlight"><pre><span></span>{% if article.ipython %}
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/theme/css/ipython.min.css&quot;</span><span class="p">&gt;</span>
{% endif %}
</pre></div>


<p>This particular post uses markdown but most of my previous posts are now converted
from ipython notebooks for example: <a href="{filename}../02/copper-quick-data-transformation-python.ipynb">copper-quick-data-transformation</a></p>
<p>If are curious about my pelican config or theme check it out on <a href="https://github.com/danielfrg/danielfrg.github.com">github</a>.</p>
<p>Happy blogging!</p>
<p class='update'><strong>Update: </strong> Check out the updated post on <a href="http://blog.laurens.xyz/blog/pelican-ipython-notebook-plugin.html">blogging with iPython notebook and pelican with a plugin</a>.</p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'iilaurens'; // required: replace example with your forum shortname

                    var disqus_identifier = 'blogging-pelican-ipython-notebook';
                var disqus_url = 'http://blog.laurens.xyz/blog/blogging-pelican-ipython-notebook.html';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2013 Laurens
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://blog.laurens.xyz/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.laurens.xyz/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.laurens.xyz/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'iilaurens'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->

</body>
</html>