<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Python Finance Package v0.02 – Basic Utils and Market Simulator - Laurens' geeky adventures</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://blog.laurens.xyz/blog/python-finance-package-v0-02-basic-utils-and-market-simulator.html">

        <meta name="author" content="Daniel Rodriguez" />
        <meta name="keywords" content="Coursera,Finance,Pandas,Python,Computational investing" />
        <meta name="description" content="Continuing with the (Basic) Python Finance Package. Now has some basic utils: total-return, daily-returns, and sharpe-ratio calculations. Also a Market Simulator, the purpose was to solve the Computational Investing Homework 3. Changes on DataAccess Now the index of the DataFrame is DatetimeIndex not string. With this is possible to index ..." />

        <meta property="og:site_name" content="Laurens' geeky adventures" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Python Finance Package v0.02 – Basic Utils and Market Simulator"/>
        <meta property="og:url" content="http://blog.laurens.xyz/blog/python-finance-package-v0-02-basic-utils-and-market-simulator.html"/>
        <meta property="og:description" content="Continuing with the (Basic) Python Finance Package. Now has some basic utils: total-return, daily-returns, and sharpe-ratio calculations. Also a Market Simulator, the purpose was to solve the Computational Investing Homework 3. Changes on DataAccess Now the index of the DataFrame is DatetimeIndex not string. With this is possible to index ..."/>
        <meta property="article:published_time" content="2012-12-17" />
            <meta property="article:section" content="12" />
            <meta property="article:tag" content="Coursera" />
            <meta property="article:tag" content="Finance" />
            <meta property="article:tag" content="Pandas" />
            <meta property="article:tag" content="Python" />
            <meta property="article:tag" content="Computational investing" />
            <meta property="article:author" content="Daniel Rodriguez" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.laurens.xyz/theme/css/bootstrap.yeti.min.css" type="text/css"/>
    <link href="http://blog.laurens.xyz/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://blog.laurens.xyz/theme/css/pygments/zenburn.css" rel="stylesheet">
    <link href="http://blog.laurens.xyz/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.laurens.xyz/theme/css/style.css" type="text/css"/>





</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://blog.laurens.xyz/" class="navbar-brand">
Laurens' geeky adventures            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li ><a href="http://blog.laurens.xyz/tags.html">Tags</a></li>
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
              <li><a href="http://blog.laurens.xyz/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.laurens.xyz/blog/python-finance-package-v0-02-basic-utils-and-market-simulator.html"
                       rel="bookmark"
                       title="Permalink to Python Finance Package v0.02 – Basic Utils and Market Simulator">
                        Python Finance Package v0.02 – Basic Utils and Market Simulator
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2012-12-17T15:00:00+01:00"> 17-12-2012</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="http://blog.laurens.xyz/tags/coursera.html">Coursera</a>
        /
	<a href="http://blog.laurens.xyz/tags/finance.html">Finance</a>
        /
	<a href="http://blog.laurens.xyz/tags/pandas.html">Pandas</a>
        /
	<a href="http://blog.laurens.xyz/tags/python.html">Python</a>
        /
	<a href="http://blog.laurens.xyz/tags/computational-investing.html">Computational investing</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Continuing with the <strong>(Basic)</strong> Python Finance Package. Now has some
basic utils: total-return, daily-returns, and sharpe-ratio calculations.
Also a Market Simulator, the purpose was to solve the <a href="https://class.coursera.org/compinvesting1-2012-001/class/index" title="Computational Investing">Computational
Investing</a> Homework 3.</p>
<h2>Changes on DataAccess</h2>
<ol>
<li>Now the index of the DataFrame is DatetimeIndex not string. With
    this is possible to index it with datetimes.</li>
<li>Moved the classes folder from './data/' to './utils/'</li>
<li>Improved Documentation</li>
</ol>
<h2>Market Simulator</h2>
<p>Reads a .csv file with the orders/trades. Downloads the necessary data
(symbols and dates between the ). Makes a simulation of the orders:</p>
<p>The .csv file looks like this:</p>
<div class="highlight"><pre><span></span>year,month,day,symbol,action,num_of_shares
2011,1,10,AAPL,Buy,1500
2011,1,13,AAPL,Sell,1500
2011,1,13,IBM,Buy,4000
2011,1,26,GOOG,Buy,1000
2011,2,2,XOM,Sell,4000
2011,2,10,XOM,Buy,4000
2011,3,3,GOOG,Sell,1000
2011,3,3,IBM,Sell,2200
2011,6,3,IBM,Sell,3300
2011,5,3,IBM,Buy,1500
2011,6,10,AAPL,Buy,1200
2011,8,1,GOOG,Buy,55
2011,8,1,GOOG,Sell,55
2011,12,20,AAPL,Sell,1200
</pre></div>


<p>How to use it:</p>
<ol>
<li>Set the initial amount of cash</li>
<li>Run the simulation,  as an argument give the path to the csv file</li>
<li>See the the information</li>
</ol>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">finance.sim</span> <span class="kn">import</span> <span class="n">MarketSimulator</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">MarketSimulator</span><span class="p">()</span>
<span class="n">sim</span><span class="o">.</span><span class="n">initial_cash</span> <span class="o">=</span> <span class="mi">1000000</span>
<span class="n">sim</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;</span><span class="n">MarketSimulator_orders</span><span class="o">.</span><span class="n">csv</span><span class="o">&amp;</span><span class="n">quot</span><span class="p">;)</span>
<span class="k">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">portfolio</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">])</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Qt4Agg&#39;</span><span class="p">)</span> \<span class="c1"># Probably most people dont need this line</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="n">sim</span><span class="o">.</span><span class="n">portfolio</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p>Output:</p>
<div class="highlight"><pre><span></span>           Portfolio
Date
2011-01-10  1000000
2011-01-11   998785
2011-01-12  1002940
2011-01-13  1004815
2011-01-14  1009415
2011-01-18  1011935
2011-01-19  1031495
2011-01-20  1031935
2011-01-21  1030775
2011-01-24  1046815
</pre></div>


<p><img alt="Simulated portfolio value" src="/images/blog/2012/12/finance02/portfolio_value.png" title="Simulated portfolio value" /></p>
<h2>Basic Utils</h2>
<p>With the portfolio ready we can get some info about it, for example the
total return and sharpe ratio.</p>
<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s1">&#39;Total Return:&#39;</span><span class="p">,</span> <span class="n">total_return</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">portfolio</span><span class="p">,</span> <span class="s1">&#39;Portfolio&#39;</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">sharpe_ratio</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">portfolio</span><span class="p">,</span> <span class="n">extraAnswers</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span>
</pre></div>


<p>Which prints:</p>
<div class="highlight"><pre><span></span><span class="n">Total</span> <span class="n">Return</span><span class="p">:</span> <span class="mf">0.1338600000000001</span>

<span class="p">{</span><span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="mf">0.0071901402219816928</span><span class="p">,</span> <span class="s1">&#39;sharpe_ratio&#39;</span><span class="p">:</span> <span class="mf">1.1836398092874625</span><span class="p">,</span> <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="mf">0.0005493527495690362</span><span class="p">}</span>
</pre></div>


<h2>Conclusion</h2>
<p>Next step is to implement an Event Profiler to solve Homework 4.</p>
<p><strong>Where to find the code?</strong> On github: <a href="https://github.com/danielfrg/PythonFinance">PythonFinance</a></p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'iilaurens'; // required: replace example with your forum shortname

                    var disqus_identifier = 'python-finance-package-v0-02-basic-utils-and-market-simulator';
                var disqus_url = 'http://blog.laurens.xyz/blog/python-finance-package-v0-02-basic-utils-and-market-simulator.html';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2013 Laurens
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://blog.laurens.xyz/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.laurens.xyz/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.laurens.xyz/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'iilaurens'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->

</body>
</html>